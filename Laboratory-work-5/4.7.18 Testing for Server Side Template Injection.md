# Підсумок
Веб-додатки зазвичай використовують серверні технології шаблонів (Jinja2, Twig, FreeMaker тощо) для створення динамічних відповідей HTML. Уразливості впровадження шаблонів на стороні сервера (SSTI) виникають, коли введені користувачем дані вбудовані в шаблон небезпечним чином і призводять до віддаленого виконання коду на сервері. Будь-які функції, які підтримують розширену розмітку, надану користувачем, можуть бути вразливими до SSTI, включаючи вікі-сторінки, огляди, маркетингові додатки, системи CMS тощо. Деякі механізми шаблонів використовують різні механізми (наприклад, пісочниця, дозвіл списку тощо) для захисту від SSTI.

# Цілі тесту

- Виявляти точки вразливості впровадження шаблону.
- Визначте механізм створення шаблонів.
- Створіть експлойт.

# Як тестувати
Уразливості SSTI існують або в тексті, або в контексті коду. У контексті відкритого тексту користувачам дозволено використовувати «текст» довільної форми з прямим кодом HTML. У контексті коду дані користувача також можуть бути розміщені в операторі шаблону (наприклад, в назві змінної)

## Визначте вразливість ін’єкції шаблону
Першим кроком у тестуванні SSTI у контексті відкритого тексту є створення загальних шаблонних виразів, які використовуються різними механізмами шаблонів як корисне навантаження, і моніторинг відповідей сервера, щоб визначити, який шаблонний вираз був виконаний сервером.

## Визначте механізм створення шаблонів
На основі інформації з попереднього кроку тепер тестувальник має визначити, який механізм шаблонів використовується, надаючи різні вирази шаблону. На основі відповідей сервера тестувальник визначає механізм використання шаблонів. Цей ручний підхід більш детально описано в цій статті PortSwigger. Для автоматизації ідентифікації вразливості SSTI та механізму створення шаблонів доступні різні інструменти, включаючи Tplmap або розширення Backslash Powered Scanner Burp Suite.

## Створіть RCE Exploit
Основна мета цього кроку — визначити можливість подальшого контролю над сервером за допомогою експлойту RCE шляхом вивчення документації шаблону та дослідження. Ключові сфери інтересів:

- Розділи для авторів шаблонів , що охоплюють базовий синтаксис.
- Розділи щодо безпеки .
- Списки вбудованих методів, функцій, фільтрів і змінних.
- Списки розширень/плагінів.
