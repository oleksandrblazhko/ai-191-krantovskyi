# Підсумок

У цьому розділі наведено приклади атак, які використовують певні функції протоколу HTTP, використовуючи слабкі сторони веб-програми або особливості способу, у який різні агенти інтерпретують HTTP-повідомлення. У цьому розділі буде проаналізовано дві різні атаки, спрямовані на певні заголовки HTTP.

Перша атака використовує відсутність санітарної обробки вхідних даних, що дозволяє зловмиснику вставляти символи CR і LF у заголовки відповіді програми та «розбивати» цю відповідь на два різних HTTP-повідомлення. Мета атаки може бути різною: від отруєння кешу до міжсайтового сценарію.

# Цілі тесту

- Оцінити, чи є програма вразливою до розбиття, визначивши можливі атаки.
- Оцінити, чи є ланцюг зв’язку вразливим до контрабанди, визначивши, які можливі атаки можна здійснити.

# Як тестувати
## Тестування чорної скриньки
### Розбиття HTTP
Деякі веб-програми використовують частину введених користувачем даних для генерування значень деяких заголовків своїх відповідей. Найпростішим прикладом є переспрямування, у яких цільова URL-адреса залежить від деякого значення, наданого користувачем. Скажімо, наприклад, що користувачеві пропонується вибрати стандартний чи розширений веб-інтерфейс. Вибір буде передано як параметр, який використовуватиметься в заголовку відповіді для запуску переспрямування на відповідну сторінку.

## Тестування сірого ящика
### Розбиття HTTP
Знання деяких деталей веб-програми та цілі атаки значною мірою допомагає успішному використанню HTTP Splitting. Наприклад, різні цілі можуть використовувати різні методи, щоб визначити, коли закінчується перше повідомлення HTTP і коли починається друге. Деякі використовуватимуть межі повідомлення, як у попередньому прикладі. Інші цілі припускатимуть, що різні повідомлення будуть передаватися різними пакетами. Інші виділять для кожного повідомлення певну кількість фрагментів попередньо визначеної довжини: у цьому випадку друге повідомлення має починатися точно на початку фрагмента, і це вимагатиме від тестувальника використання відступу між двома повідомленнями. Це може спричинити деякі проблеми, коли вразливий параметр потрібно надіслати в URL-адресу, оскільки дуже довгу URL-адресу, ймовірно, буде скорочено або відфільтровано. Сценарій «сірого ящика» може допомогти зловмиснику знайти обхідний шлях: наприклад, кілька серверів додатків дозволять надсилати запит за допомогою POST замість GET.

### Контрабанда HTTP
Як згадувалося у вступі, HTTP Smuggling використовує різні способи аналізу та інтерпретації спеціально створеного HTTP-повідомлення різними агентами (браузерами, веб-кешами, брандмауерами програм). Цей відносно новий вид атаки вперше виявили Хаїм Лінхарт, Аміт Кляйн, Ронен Хелед і Стів Оррін у 2005 році. Існує кілька можливих застосувань, і ми проаналізуємо одне з найбільш вражаючих: обхід брандмауера програми. Щоб отримати детальнішу інформацію та інші сценарії, зверніться до оригінального технічного документу (посилання на яке знаходиться внизу цієї сторінки).
