# V2.2 Загальні вимоги до автентифікатора

Гнучкість автентифікатора є важливою для перспективних програм. Перепишіть верифікатори додатків, щоб дозволити додаткові
автентифікатори відповідно до налаштувань користувача, а також вилучення застарілих або небезпечних автентифікаторів.

NIST вважає електронну пошту та SMS "обмеженими" типами автентифікаторів, і їх, ймовірно, буде видалено з NIST
800-63 і, отже, ASVS в якийсь момент майбутнього. Додатки повинні планувати дорожню карту, яка не вимагає
використання електронної пошти або SMS.

## Опис
### 2.2.1 (CWE - 307)

Перевірити, чи ефективні антиавтоматичні засоби керування для зменшення кількості порушених тестів на довіреності та нападів блокування облікового запису. Такі засоби керування включають блокування найпоширеніших порушених паролів, м'якого блокування, обмеження курсу, CAPTCHA, постійно зростаючі затримки між спробами, обмеження IP-адрес, або обмеження на основі ризику, такі як місцезнаходження, перший вхід на пристрій, нещодавні спроби розблокувати обліковий запис, або аналогічні. Переконайтеся, що на одному обліковому записі можливі не більше 100 невдалих спроб на годину.

### 2.2.2 (CWE - 304)

Перевірте, що використання слабких автентифікаторів (таких як SMS і електронна пошта) обмежено використанням для додаткової перевірки та схвалення транзакцій, і не використовується як заміна більш надійним методам автентифікації. Перевірте, що перед використанням слабких методів доступні сильні методи, користувачі обізнані з ризиками, або що вжиті належні заходи для обмеження ризику компроментації облікового запису.

### 2.2.3 (CWE - 620)

Перевірте, що користувачам надсилаються безпечні сповіщення після оновлення даних для автентифікації, таких як скидання облікових даних, зміни електронної пошти або адреси, а також після входу з невідомих або ризикових місцезнаходжень. Використання сповіщень за допомогою push-технологій, а не SMS або електронної пошти, є бажаним, але відсутність можливості використовувати push-сповіщення допускає використання SMS або електронної пошти, за умови, що в них не розголошується чутлива інформація.

### 2.2.4 (CWE - 308)

Перевірте стійкість до імперсонації у випадку фішингу, таку як використання багатофакторної автентифікації, криптографічних пристроїв з наміром (наприклад, підключених ключів із кнопкою для автентифікації) або, на вищих рівнях AAL, сертифікатів на клієнтському боці.

### 2.2.5 (CWE - 319)

Переконайтесь, що в разі розділення постачальника облікових даних (CSP) та додатку, який перевіряє автентифікацію, між цими двома кінцевими точками встановлено двосторонню аутентифікацію TLS.

### 2.2.6 (CWE - 308)

Перевірте стійкість до повторного відтворення за допомогою обов'язкового використання пристроїв з одноразовими паролями (OTP), криптографічних автентифікаторів або кодів для пошуку.

### 2.2.7 (CWE - 308)

Переконайтесь у намірі автентифікації, вимагаючи введення OTP-токена або дій користувача, таких як натискання кнопки на апаратному ключі FIDO, ініційовані користувачем.

## Опис CWE 
### CWE 304
#### Опис

Продукт реалізує метод автентифікації, але пропускає якийсь крок, що призводить до послаблення цього методу.

#### Розширений опис

Техніки автентифікації повинні точно відповідати алгоритмам, які їх визначають, інакше автентифікацію можна обійти або вона стане більш доступною для атак методом грубої сили.

#### Платформи

Клас: Не залежить від мови програмування

#### Загальні наслідки

Управління доступом, Цілісність, Конфіденційність.

Ця вразливість може призвести до розкриття ресурсів або функціональності несанкціонованим суб'єктам, що може надати атакуючим доступ до чутливої інформації або дозволити їм виконувати довільний код.

### CWE 307
#### Опис

Продукт не реалізує достатні заходи для запобігання кільком невдалим спробам автентифікації протягом короткого періоду часу, що робить його більш уразливим перед атаками методом грубої сили.

#### Платформи

Клас: Не залежить від мови програмування

#### Загальні наслідки

Управління доступом.

Атакуючий може виконувати довільну кількість спроб автентифікації, використовуючи різні паролі, і, врешті-решт, отримати доступ до цільового облікового запису.

### CWE 308
#### Опис

Використання однофакторної автентифікації може призвести до надмірного ризику компрометації порівняно з перевагами схеми двофакторної автентифікації.

#### Розширений опис

Використання декількох схем автентифікації дійсно додає більше складності до процесу автентифікації, але такі заходи резервності мають безцінну цінність. Використання слабких, використовуваних і загальних паролів є поширеним в інтернеті. Без додаткового захисту з боку різних схем автентифікації одна помилка може призвести до компрометації облікового запису. З цієї причини, якщо можливе та легко впроваджується декілька схем автентифікації, їх рекомендується використовувати та вимагати.

#### Платформи

Клас: Не залежить від мови програмування

#### Загальні наслідки

Управління доступом.

Якщо секрет в однофакторній схемі автентифікації стає відомим зловмиснику, то він може провести повну автентифікацію. У такому випадку, атакуючий може отримати доступ до облікового запису або ресурсів, оскільки єдиний фактор, такий як пароль або токен, є недостатньою заходом безпеки.

### CWE 319
#### Опис

Продукт передає чутливі або критичні для безпеки дані у відкритому вигляді (cleartext) через комунікаційний канал, який може бути перехоплений несанкціонованими суб'єктами.

#### Розширений опис

Багато каналів зв'язку можуть бути "перехоплені" (моніторені) противниками під час передачі даних. Наприклад, в мережах пакети можуть проходити через багато проміжних вузлів від джерела до призначення, чи то через інтернет, внутрішню мережу, хмару тощо. Деякі суб'єкти можуть мати привілейований доступ до інтерфейсу мережі або будь-якого ланцюжка вздовж каналу, такого як маршрутизатор, але вони можуть не мати дозволу на збір основних даних. Внаслідок цього мережевий трафік може бути перехоплений противниками, що призводить до розкриття критичних для безпеки даних.

Застосовні канали зв'язку не обмежені лише програмними продуктами. Сюди включаються технології, пов'язані з апаратними засобами, такі як внутрішні апаратні мережі та зовнішні канали налагодження, що підтримують віддалене налагодження через JTAG. Коли заходи для боротьби з противниками в рамках моделі загрози продукту не застосовуються, ця вразливість значно знижує складність її використання такими противниками.

Коли весь зв'язок записується або логується, наприклад, за допомогою дампу пакетів, противник може намагатися отримати дамп довго після закінчення передачі та спробувати "перехопити" відкритий текст з записаних комунікацій у самому дампі. Навіть якщо інформація закодована у формі, яка не призначена для читання людьми, застосування певних технік може визначити, який кодування використовується, і розкодувати інформацію.

#### Платформи

Клас: Не залежить від мови програмування

Клас: Хмарні обчислення

Клас: Мобільний

Клас: ICS/OT

Клас: Системи на чіпі

Тести/Апаратна частина налагодження

#### Загальні наслідки

Цілісність, Конфіденційність.

Будь-хто може прочитати інформацію, отримавши доступ до каналу, який використовується для комунікації.

### CWE 620
#### Опис

При встановленні нового пароля для користувача продукт не вимагає знання оригінального пароля або використання іншої форми автентифікації.

#### Розширений опис

Це може бути використано зловмисником для зміни паролю іншого користувача, отримуючи таким чином привілеї, пов'язані з цим користувачем.

#### Платформи

Клас: Не залежить від мови програмування

#### Загальні наслідки

Управління доступом.
